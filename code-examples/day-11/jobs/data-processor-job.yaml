apiVersion: batch/v1
kind: Job
metadata:
  name: process-data
spec:
  completions: 10       # Process 10 batches
  parallelism: 3        # 3 workers in parallel
  template:
    spec:
      restartPolicy: OnFailure
      containers:
      - name: processor
        image: python:3.9-slim
        command:
        - python
        - -c
        - |
          import time
          import random
          import os
          
          pod_name = os.environ.get('HOSTNAME', 'unknown')
          print(f"Worker {pod_name} starting...")
          
          # Simulate processing
          batch_id = random.randint(1000, 9999)
          print(f"Processing batch {batch_id}")
          
          for i in range(5):
              print(f"  Processing record {i+1}/5")
              time.sleep(2)
          
          print(f"Batch {batch_id} complete!")
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 200m
            memory: 256Mi

